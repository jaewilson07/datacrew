---
title : Connecting to an OLAP Cube in Workbench 5.1
categories: ['https://domo-support.domo.com/s/topic/0TO5w000000ZamwGAC']
date: 2022-10-24 22:40:00
url : https://domo-support.domo.com/s/article/4407020117527
linked_kbs :  ['https://domo-support.domo.com/s/article/4404246789783', 'https://domo-support.domo.com/s/article/4407012982295', 'https://domo-support.domo.com/s/knowledge-base', 'https://domo-support.domo.com/s/article/360042925494', 'https://domo-support.domo.com/s/article/4407033576471', 'https://domo-support.domo.com/s/article/360043429953', 'https://domo-support.domo.com/s/article/4407013084439', 'https://domo-support.domo.com/s/article/4407022083351', 'https://domo-support.domo.com/s/article/4407019431831', 'https://domo-support.domo.com/s/article/360043429933', 'https://domo-support.domo.com/s/article/360043429693', 'https://domo-support.domo.com/s/topic/0TO5w000000ZamwGAC', 'https://domo-support.domo.com/s/article/4407020117527', 'https://domo-support.domo.com/s/article/4407021587735', 'https://domo-support.domo.com/s/article/4407013674519', 'https://domo-support.domo.com/s/article/4407013819671', 'https://domo-support.domo.com/s/article/360043429913']
article_id : 000004873
views : 3,977
created_date : 2022-10-24 22:32:00
last updated : 2022-10-24 22:40:00
---



You can create an OLAP DataSet Job in Workbench 5.1. When you select OLAP as your Data Source type, you can provide the details of your connection and configure your query.


**To create an OLAP DataSet Job in Workbench 5.1,**


1. Click the ![wb5_jobs_icon.png](wb5_jobs_icon.png)Â icon in the left-hand icon bar.Â
2. Click the "+" button in the top right corner of the jobs listing pane.
3. Select the desired account (DomoÂ instance) in the **Domo Domain**Â dropdown menu.  
If you have only one account set up, that account is already chosen for you and the menu is unavailable.
4. In the **Name** field, enter a name for the DataSet Job.  
This is the name of theÂ job as it appears in Workbench,Â *not* the name of the uploaded DataSet in Domo.
5. In theÂ **Transport Type** menu,Â select **OLEDB Connection Provider**.
6. In theÂ **Reader TypeÂ**menu, selectÂ **Database Query**.
7. In theÂ **DataSet Name** field, enter the name of the DataSet. This is the name of the uploaded DataSet in Domo.  
This is theÂ *only*Â setting you can change after saving the new job.
8. In theÂ **DataSet Type** field, selectÂ the type of DataSet in the dropdown.  
The DataSet type you selectÂ or enter here is reflected asÂ the connector type in Domo after you execute the job.
9. Enter a description for the DataSetÂ if desired.  
This is the description of the DataSet as it appears in Domo.Â
10. ClickÂ **Create**.  
  
A newÂ OLAP DataSet Job is added toÂ theÂ list of jobs for the currently authenticated account.Â Note that after creating the job, you cannot edit any of the settings you just configured except for the DataSet name.Â If you want to change any of the other settings, you must create a new job.Â
11. Click theÂ **Configure**Â subtab.
12. Click theÂ **Edit**Â button under "Source."  
  
A panel opensÂ with options for configuring yourÂ OLAP connectionÂ andÂ defining your query.
13. In the **OLAP Connection** field, do one of the following:



	* Enter an OLAP connection string containing your Provider (MSOLAP or Essbase), Data Source, Initial Catalog, and User ID and Password.
	* Build your connection string by filling in the fields in the **Connection Builder**, then click **Apply**Â to add the string to the **OLAP Connection**Â field. You can open the **Connection Builder** by clicking the arrow in the **OLAP Connection** field.  
	  
	The following table describes all of the parameters in the **Connection Builder:**
	
	
	
	| Option | Description |
	| --- | --- |
	| Data SourceÂ  | Specifies the server where the database is located.Â  |
	| ProviderÂ  | Select a provider, either MSOLAP or Essbase.Â  |
	| CatalogÂ  | Specifies the Initial Catalog for your OLAP connection.Â  |
	| UsernameÂ  | Specifies the username for this OLAP connection.Â  |
	| PasswordÂ  | Specifies the password for this OLAP connection.Â  |
14. (Optional) Check the "Requires 32-bit execution" box if 32-bit execution is needed for this connection.Â
15. Click **Apply.**
16. Click theÂ **Edit**Â button under "Processing."
17. Change theÂ **Query Execution Timeout**Â value if desired.  
This is the amount of time in seconds that will elapse before a long-running job is terminated.
18. In theÂ **Query** subtab, enterÂ a query for the data you want to retrieve.Â For example:  
  
`with member [Measures].[PCT Discount] AS '[Measures].[Discount Amount]/[Measures].[Sales Amount]', FORMAT_STRING = 'Percent'  
 set Top10SellingProducts as 'topcount([Product].[Model Name].children, 10, [Measures].[Sales Amount])'  
 set Preferred10Products as '  
 {[Product].[Model Name].&[Mountain-200],  
 [Product].[Model Name].&[Road-250],  
 [Product].[Model Name].&[Mountain-100],  
 [Product].[Model Name].&[Road-650],  
 [Product].[Model Name].&[Touring-1000],  
 [Product].[Model Name].&[Road-550-W],  
 [Product].[Model Name].&[Road-350-W],  
 [Product].[Model Name].&[HL Mountain Frame],  
 [Product].[Model Name].&[Road-150],  
 [Product].[Model Name].&[Touring-3000]  
 }'  
 select {[Measures].[Sales Amount], [Measures].[Discount Amount], [Measures].[PCT Discount]} on 0,  
 Preferred10Products on 1  
 from [Analysis Services Tutorial]`
19. (Optional)Â Define replacement variables for columns in the DataSet in theÂ **Replacement Variables**Â and **Global Replacement Variables**Â subtabs.Â For each replacement variable...


	1. Select theÂ applicable column in theÂ **Column Dropdown**.
	
	
	**Note:Â**The **Column** dropdown does not populate until you create a successful OLAP connection in the **Source** menu.
	2. Define replacement variables for the selected column in the **Value** dropdown.
	
	
	
	| Variable Type | Description |
	| --- | --- |
	| lastvalue | lastvalue variables keep track of relevant fields for the last row of data that was sent with the most recent upload for the associated job. The syntax is
	`!{lastvalue:_name_}!`
	lastvalue variables values are updated by Workbench after an upload finishes. lastvalue variables are stored in the job (.xml) file. This variable lets you construct a query that gets only the "new" rows each time it runs. For example, if your data has a column with a row "id" that increments with each new row, you can construct a query containing
	`!{lastvalue:id}!`
	similar to the following:
	`select id, name, type, sales from tablename where id > !{lastvalue:id}! order by id`
	In this example, the column "id" *must* be in the SELECT, WHERE, and ORDER BY clauses for the variable to be used and updated.
	When uploading this job, Workbench replaces the
	`!{lastvalue:id}!`
	variable with the current value of "id". After finishing the upload, Workbench stores the last uploaded value of "id" in the job (.xml) file.
	**Note:Â**You *must* include any column you reference with a lastvalue variable in your SELECT, WHERE, and ORDER BY clauses in order for the variable to be used and updated after the data upload. |
	| previewonly | Used to indicate that certain actions should take place when loading a preview in Workbench. For example, you couldÂ request that your preview return only 100 rows of data instead ofÂ the 1,000,000 present in the data source.Â The syntax is
	`!{previewonly:Statement}!` |
20. ClickÂ **Apply**.
21. Select the desiredÂ update method in theÂ **Update Method** menu:



	* SelectÂ **Replace DataSet** if you want the DataSet to be replaced entirely upon updating.
	* SelectÂ **Append to DataSet** if you wantÂ new data to be added to the existing data set upon updating.


You are now ready to execute the DataSet Job, thereby creating an OLAPÂ DataSet in Domo. However, there are many other actions you can take on the DataSet Job before you send it to Domo. These include the following:



* [Scheduling a Job in Workbench 5.1](..\scheduling_a_job_in_workbench_51\index.html "Scheduling a Job in Workbench 4")
* [Configuring notifications to be sent when the job update succeeds or fails](..\setting_notifications_in_workbench_51\index.html "Setting Notifications in Workbench 4")
* [Encrypting and decrypting Workbench data](..\encrypting_decrypting_and_hashing_workbench_51_data\index.html "Encrypting and Decrypting Workbench 4 Data")
* [Creating new columns using calculations](..\creating_columns_in_workbench_51_using_calculations\index.html "Creating Columns in Workbench 4 Using Calculations")
* [Setting a custom date format on a column](..\setting_a_custom_date_format_on_a_column_in_workbench_51\index.html "Setting a Custom Date Format on a Column in Workbench 4")
* [Replacing a value in a column](..\replacing_a_column_value_in_workbench_51\index.html "Replacing a Column Value in Workbench 4")
* [Combining DataSets](..\combining_datasets_in_workbench_51\index.html "Combining DataSets in Workbench 4")
* [Applying filters to columns](..\filtering_columns_in_workbench_51\index.html "Filtering Columns in Workbench 4")
* [Setting impersonation](..\workbench_51_training_topics\index.md) (which causes Workbench to run the job as an Active Directory user).